import csv

count = 0
all_data = {}
# open the file for reading
with open('ACS_11_1YR_Consolidated.csv', 'rU') as f:
    reader = csv.reader(f)
    curState = 0
    indent = "    "
    startup = True

    # Creating the output file for writing
    output = open("data_output_locale_census_data.json", "wb")

    output.write("{\n")

    #iterate through each row
    for row in reader:
        # exclude the header row
        if count != 0:
            if (row[149] != curState):
                curState = row[149]
                if (startup != True):
                    output.write(indent + indent + indent + "}\n")
                    output.write(indent + indent + "}\n")
                    output.write(indent + "},\n")
                else:
                    startup = False

                output.write(indent + "\"" + curState + "\":{\n")
                output.write(indent + indent + "\"state\":\"" + row[150] + "\",\n")
                output.write(indent + indent + "\"locales\":{\n")

            else:
                output.write(indent + indent + indent + "},\n")

            output.write(indent + indent + indent + "\"" + row[0] + "\":{\n")
            output.write(indent + indent + indent + indent + "\"locale\":\"" + row[151] + "\",\n")
            output.write(indent + indent + indent + indent + "\"workHome%\":" + row[1] + ",\n")
            output.write(indent + indent + indent + indent + "\"meanCommute%\":" + row[2] + ",\n")
            output.write(indent + indent + indent + indent + "\"occ\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"mgmtBusSciArt\":" + row[3] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"service\":" + row[4] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"salesOff\":" + row[5] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"natresConstrMaint\":" + row[6] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"prodTrans\":" + row[7] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"agForMine\":" + row[8] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"indust\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"constr%\":" + row[9] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"mfg%\":" + row[10] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"wholesal%\":" + row[11] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"retail%\":" + row[12] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"transStorUtil%\":" + row[13] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"info%\":" + row[14] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"finRealest%\":" + row[15] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"proSciMgmtAdmin%\":" + row[16] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"eduHealth%\":" + row[17] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"svcEnt%\":" + row[18] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"other%\":" + row[19] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"pubAdmin%\":" + row[20] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"employer\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"priv%\":" + row[21] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"pub%\":" + row[22] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"self%\":" + row[23] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"households\":" + row[24] + ",\n")
            output.write(indent + indent + indent + indent + "\"householdInc\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"under10k\":" + row[25] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"10kto14k\":" + row[26] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"15kto24k\":" + row[27] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"25kto34k\":" + row[28] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"35kto49k\":" + row[29] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"50kto74k\":" + row[30] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"75kto99k\":" + row[31] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"100kto149k\":" + row[32] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"150kto199k\":" + row[33] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"200kup\":" + row[34] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"medianHouseInc\":" + row[35] + ",\n")
            output.write(indent + indent + indent + indent + "\"meanHouseInc\":" + row[36] + ",\n")
            output.write(indent + indent + indent + indent + "\"houseSocSec%\":" + row[37] + ",\n")
            output.write(indent + indent + indent + indent + "\"houseRetirInc%\":" + row[38] + ",\n")
            output.write(indent + indent + indent + indent + "\"houseSupSec%\":" + row[39] + ",\n")
            output.write(indent + indent + indent + indent + "\"houseFoodStamp%\":" + row[40] + ",\n")
            output.write(indent + indent + indent + indent + "\"perCapIncome\":" + row[41] + ",\n")
            output.write(indent + indent + indent + indent + "\"medianWorkEarn\":" + row[42] + ",\n")
            output.write(indent + indent + indent + indent + "\"medianMaleEarn\":" + row[43] + ",\n")
            output.write(indent + indent + indent + indent + "\"medianFemaleEarn\":" + row[44] + ",\n")
            output.write(indent + indent + indent + indent + "\"healthIns%\":" + row[45] + ",\n")
            output.write(indent + indent + indent + indent + "\"healthInsPriv%\":" + row[46] + ",\n")
            output.write(indent + indent + indent + indent + "\"healthInsPub%\":" + row[47] + ",\n")
            output.write(indent + indent + indent + indent + "\"healthInsUnder18%\":" + row[48] + ",\n")
            output.write(indent + indent + indent + indent + "\"povFamAll%\":" + row[49] + ",\n")
            output.write(indent + indent + indent + indent + "\"povFamUnder18%\":" + row[50] + ",\n")
            output.write(indent + indent + indent + indent + "\"povFamMarried%\":" + row[51] + ",\n")
            output.write(indent + indent + indent + indent + "\"povFamFemHead%\":" + row[52] + ",\n")
            output.write(indent + indent + indent + indent + "\"pop\":" + row[53] + ",\n")
            output.write(indent + indent + indent + indent + "\"popGender\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"female%\":" + row[55] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"male%\":" + row[54] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"age\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"under5%\":" + row[56] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"5to9%\":" + row[57] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"10to14%\":" + row[58] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"15to19%\":" + row[59] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"20to24%\":" + row[60] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"25to34%\":" + row[61] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"35to44%\":" + row[62] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"45to54%\":" + row[63] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"55to59%\":" + row[64] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"60to64%\":" + row[65] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"65to74%\":" + row[66] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"75to84%\":" + row[67] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"85above%\":" + row[68] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"medianAge\":" + row[69] + ",\n")
            output.write(indent + indent + indent + indent + "\"race\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"afAm\":" + row[72] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"amInd\":" + row[73] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"asian\":" + row[74] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"pacIsland\":" + row[75] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"white\":" + row[71] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"other\":" + row[76] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"moreThanOne\":" + row[70] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"ethnicity\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"hisp\":" + row[77] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"nonHisp\":" + row[78] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"ed\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"belowHS\":" + row[79] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"hs\":" + row[80] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"someCollege\":" + row[81] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"bs\":" + row[82] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"ms\":" + row[83] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"birth\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"inState\":" + row[84] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"outState\":" + row[85] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"citOutUS\":" + row[86] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"foreignBorn\":" + row[87] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"housingUnits\":" + row[88] + ",\n")
            output.write(indent + indent + indent + indent + "\"occupied%\":" + row[89] + ",\n")
            output.write(indent + indent + indent + indent + "\"vacant%\":" + row[90] + ",\n")
            output.write(indent + indent + indent + indent + "\"ownerVac%\":" + row[91] + ",\n")
            output.write(indent + indent + indent + indent + "\"rentalVac%\":" + row[92] + ",\n")
            output.write(indent + indent + indent + indent + "\"singleUnit%\":" + row[93] + ",\n")
            output.write(indent + indent + indent + indent + "\"mobileHome%\":" + row[94] + ",\n")
            output.write(indent + indent + indent + indent + "\"houseAge\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"2005Newer%\":" + row[95] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"2000to2004%\":" + row[96] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1990to1999%\":" + row[97] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1980to1989%\":" + row[98] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1970to1979%\":" + row[99] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1960to1969%\":" + row[100] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1950to1959%\":" + row[101] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1940to1949%\":" + row[102] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1939Older%\":" + row[103] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"houseSize\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"1Br%\":" + row[104] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"2Br%\":" + row[105] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"3Br%\":" + row[106] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"4Br%\":" + row[107] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"5BrMore%\":" + row[108] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"occupant\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"ownerOcc%\":" + row[109] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"renterOcc%\":" + row[110] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"moveIn\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"2005Newer%\":" + row[111] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"2000to2004%\":" + row[112] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1990to1999%\":" + row[113] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1980to1989%\":" + row[114] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1970to1979%\":" + row[115] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1969Before%\":" + row[116] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"houseValue\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"lessThan50k%\":" + row[117] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"50kto99k%\":" + row[118] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"100kto149k%\":" + row[119] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"150kto199k%\":" + row[120] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"200kto299k%\":" + row[121] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"300kto499k%\":" + row[122] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"500kto999k%\":" + row[123] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1MOrMore%\":" + row[124] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"medianHomeVal\":" + row[125] + ",\n")
            output.write(indent + indent + indent + indent + "\"mortgage\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"withMort%\":" + row[126] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"noMort%\":" + row[127] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"monthlyCostMort\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"under300%\":" + row[128] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"300to499%\":" + row[129] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"500to699%\":" + row[130] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"700to999%\":" + row[131] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1kto1499%\":" + row[132] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1500to1999%\":" + row[133] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"2kOrMore%\":" + row[134] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"medianMortMonth\":" + row[135] + ",\n")
            output.write(indent + indent + indent + indent + "\"monthCostNoMort\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"under200%\":" + row[136] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"200to299%\":" + row[137] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"300to399%\":" + row[138] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"400OrMore%\":" + row[139] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"medianNoMortMonth\":" + row[140] + ",\n")
            output.write(indent + indent + indent + indent + "\"monthRent\":{\n")
            output.write(indent + indent + indent + indent + indent + "\"under200%\":" + row[141] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"200to299%\":" + row[142] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"300to499%\":" + row[143] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"500to699%\":" + row[144] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"700to999%\":" + row[145] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1kto1499%\":" + row[146] + ",\n")
            output.write(indent + indent + indent + indent + indent + "\"1500OrMore%\":" + row[147] + "\n")
            output.write(indent + indent + indent + indent + "},\n")
            output.write(indent + indent + indent + indent + "\"medianRent\":" + row[148] + "\n")
            # output.write(indent + indent + indent + "},\n")
        count += 1
    output.write(indent + indent + indent + "}\n")
    output.write(indent + indent + "}\n")
    output.write(indent + "}\n")
    output.write("}\n")

    output.close()